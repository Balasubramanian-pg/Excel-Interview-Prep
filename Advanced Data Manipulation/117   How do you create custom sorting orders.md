### 117. How do you create custom sorting orders?

Standard A-Z or Z-A sorting doesn't work for business logic that requires a specific, non-alphabetic order (e.g., sorting priorities as "High," "Medium," then "Low"). In modern Excel, you can achieve this dynamically by combining the `SORTBY` and `XMATCH` functions.

### Single-Level Custom Sort

This method sorts a table based on a single column that needs to follow a custom order.

**Formula:**
```excel
=SORTBY(A1:B100, XMATCH(B1:B100, {"High","Medium","Low"}))
```
*   `A1:B100`: The full range of data you want to sort.
*   `B1:B100`: The column that contains the values you want to sort by (the "by array").
*   `{"High","Medium","Low"}`: Your custom sort order, defined as an array constant.

**How it works:**
The magic of this formula is how `XMATCH` transforms your custom list into a sortable numeric index.
1.  `XMATCH(B1:B100, {"High","Medium","Low"})`: This function looks at each cell in `B1:B100`. It finds the position of that cell's value within your custom order array.
    *   If a cell in B contains "High", `XMATCH` returns `1`.
    *   If a cell contains "Medium", `XMATCH` returns `2`.
    *   If a cell contains "Low", `XMATCH` returns `3`.
2.  `SORTBY(...)`: This function then uses the array of numbers generated by `XMATCH` (e.g., `{1; 3; 2; 1; ...}`) as the sorting key. By sorting this numeric array in ascending order, it effectively arranges your original data (`A1:B100`) according to your custom-defined order.

> [!TIP]
> Instead of hardcoding the order `{"High","Medium","Low"}` into the formula, it's better practice to list it in a range of cells (e.g., `E1:E3`) or define it as a named range (e.g., `PriorityOrder`). This makes your formula cleaner and easier to update.
>
> **Example with a range:**
> `=SORTBY(A1:B100, XMATCH(B1:B100, E1:E3))`

### Multi-Level Custom Sort

You can extend this logic to sort by multiple columns, each with its own custom order, creating a primary and secondary sort level.

**Formula:**
```excel
=SORTBY(A1:C100, XMATCH(B1:B100, CustomOrder1), 1, XMATCH(C1:C100, CustomOrder2), 1)
```

**How it works:**
The `SORTBY` function can accept multiple `by_array`/`sort_order` pairs.
*   `XMATCH(B1:B100, CustomOrder1), 1`: This is the **primary sort level**. It sorts the data based on the custom order defined in `CustomOrder1` (a named range for your first list) in ascending (`1`) order.
*   `XMATCH(C1:C100, CustomOrder2), 1`: This is the **secondary sort level**. If any rows have the same priority in the first sort level, this criterion is used to break the tie. It sorts those tied rows based on the custom order in `CustomOrder2` (your second custom list).

### Alternative Method: Helper Column (All Excel Versions)

If you are not using Excel 365, you can achieve a custom sort using a helper column and the standard Sort feature.

1.  Create a helper column next to your data.
2.  In this column, use the `MATCH` function to get the numeric index for each row based on your custom order list.
    ```excel
    =MATCH(B1, $E$1:$E$3, 0)
    ```
3.  Copy this formula down the entire column.
4.  Select your entire data range (including the helper column) and go to **Data > Sort**.
5.  In the Sort dialog box, choose to sort by your helper column from **Smallest to Largest**.

> [!NOTE]
> This helper column method is **static**. If your source data changes, you will need to manually re-apply the sort. The dynamic `SORTBY` formula updates automatically.
